# Aarambh 112 - Computer Aided Dispatch (CAD) System

Aarambh 112 is a next-generation Computer Aided Dispatch (CAD) system designed to streamline emergency response operations. This dashboard provides dispatchers with real-time situational awareness, AI-driven insights, and efficient resource management tools.

![Status](https://img.shields.io/badge/Status-Prototype-green) 
![Python](https://img.shields.io/badge/Backend-FastAPI-blue) 
![React](https://img.shields.io/badge/Frontend-React-cyan) 
![AI](https://img.shields.io/badge/AI-Gemini%202.0%20Flash-orange)

## Key Features

### Dispatcher Dashboard
A unified, single-screen interface designed for high-pressure environments. The layout is optimized for quick information intake and decision-making.

### Call & Situation Management
- **Call Details Panel**: Displays real-time caller information including Name, Contact, Location, and Incident Type.
- **Situation Assessment**: Tracks critical patient vitals (Consciousness, Breathing) and reported symptoms.
- **Live Notes**: Auto-generated notes from the voice agent intake, including fake call probability and language detection.

### GIS Map Panel
- **Interactive Map**: Built with Leaflet, providing a dark-mode visualization of the incident location.
- **Real-time Tracking**: Visualizes the incident location and the real-time positions of available resources (Ambulances, Fire, Police).
- **Route Visualization**: Shows estimated routes from resources to the incident scene.

### Resource Management
- **Smart Resource Table**: Lists available units with calculated ETAs and distances based on live location data.
- **AI Suggestions**: Automatically highlights the most appropriate resources based on the incident type (e.g., suggesting ALS Ambulances for Cardiac Arrest).
- **One-Click Dispatch**: Streamlined selection and dispatch process.

### AI Assistant
- **Protocol Guidance**: An integrated chat assistant that guides dispatchers through standard operating protocols (SOPs).
- **Smart Recommendations**: Suggests next steps and resources based on the evolving situation.

## Tech Stack
- **Frontend**: React 19, Vite
- **Maps**: Leaflet, React-Leaflet
- **Styling**: CSS Modules, Responsive Grid Layout
- **State Management**: React Hooks (useState, useEffect)

## Setup & Installation

1. **Clone the repository**
   ```bash
   git clone https://github.com/ChiragAgarwal78/Aarambh.git
   cd Aarambh
   ```

2. **Install dependencies**
   ```bash
   npm install
   ```

3. **Run the development server**
   ```bash
   npm run dev
   ```

4. **Build for production**
   ```bash
   npm run build
   ```

## Dashboard Overview
The dashboard features a responsive 3-column layout:
1. **Left**: Caller Details & Situation Assessment
2. **Center**: GIS Map & Resource Table (with Action Bar)
3. **Right**: AI Assistant & Protocol Chat

#  Tech Stack

## Backend & AI
- FastAPI, Uvicorn, WebSockets  
- LangGraph, LangChain  
- Google Gemini 2.0 Flash  
- Twilio Voice  
- Deepgram Nova-2 & Aura  
- Pinecone, BM25, Flashrank  

## Frontend
- React 19 + Vite  
- Leaflet + React-Leaflet  
- CSS Modules + Responsive Grid  

---

#   Project Structure

```text
Aarambh/
├── main.py                 # FastAPI server (Voice + API)
├── call_section.py         # Twilio/Deepgram streaming handler
├── app.py                  # Streamlit RAG Assistant
├── incident_reports/       # Auto-generated JSON reports
├── pipeline/               # AI Brain (State Machine + Prompts)
│   ├── pipline.py
│   ├── agents.py
│   └── schema.py
├── frontend/               # React CAD Dashboard
├── requirements.txt
└── .env                    # API keys config

---

##  Setup & Installation

### 1. Prerequisites
Create a .env file in the root directory with the following keys:
ini
GEMINI_API_KEY=...
DEEPGRAM_API_KEY=...
PINECONE_API_KEY=...
GOOGLE_API_KEY=... # For LangChain RAG


### 2. Backend Setup
bash
# Create virtual environment
python -m venv venv
source venv/bin/activate  # or venv\\Scripts\\activate on Windows

# Install dependencies
pip install -r requirements.txt


### 3. Frontend Setup
bash
cd frontend
npm install


### 4. Expose Localhost (For Twilio)
Since Twilio needs to communicate with your local WebSocket, use ngrok to tunnel the connection:
bash
ngrok http 8000

*Copy the forwarding URL (e.g., https://abc-123.ngrok.io) and update SERVER_DOMAIN in call_section.py.*

---

##  Usage Guide

### Mode A: The Voice Agent (Real Call)
1.  *Run the FastAPI Server:*
    bash
    python main.py
    
2.  *Configure Twilio:* Set your Phone Number webhook to https://<your-ngrok-url>/incoming_call.
3.  *Action:* Call the number. The AI will answer: "911, what is your emergency?"
4.  *Result:* After the call, check the incident_reports/ folder for the generated JSON.

### Mode B: The Operator Console (RAG + Reports)
1.  *Run the Streamlit App:*
    bash
    streamlit run app.py
    
2.  *Sidebar:* Click "Refresh Files" to see new incident reports generated by Mode A.
3.  *Main Chat:* Ask questions like "What is the protocol for cardiac arrest?"

### Mode C: The CAD Dashboard (Visuals)
1.  *Start the React dev server:*
    bash
    cd frontend
    npm run dev
    
2.  *Action:* Open http://localhost:5173 to view the map and dispatch interface.

---

##  API Endpoints

| Method | Endpoint | Description |
| :--- | :--- | :--- |
| *POST* | /incoming_call | Twilio webhook entry point (TwiML response) |
| *WS* | /audio_stream | Bi-directional audio stream for Voice AI |
| *POST* | /chat | Text-only endpoint to test the pipeline without voice |

---

## How the Pipeline Works

1.  *Listen:* Deepgram streams raw audio → Text.
2.  *Buffer:* Python buffers text for 1.2s to detect complete sentences.
3.  *Extract:* Gemini (via LangGraph) extracts entities (Location, Type, Severity).
4.  *Verify:* The agent checks if critical info is missing.
    * Missing Location? → Agent asks "Where are you located?"
    * Complete? → Agent says "Dispatching units."
5.  *Speak:* Text response is streamed back to Deepgram Aura → Audio → Twilio